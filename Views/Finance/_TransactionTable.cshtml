@model List<TransactionModel>

@{
    var tdClass = ViewData["tdClass"] as string;
    var isExpected = tdClass != null;
}

<script>
    const confirmDelete = (id, name) => {
        let confirmed = confirm(`Delete transaction "${name}"?`);
        if (!confirmed) return;
        
        fetch('/Finance/DeleteTransaction/', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(id)
        })
    }
</script>

<table class="table table-light">
    <tbody>
    @foreach (var transaction in Model)
    {
        var prefix = transaction.IsIncome ? "+" : "-";
        var prefixClass = transaction.IsIncome ? "text-success" : "text-danger";

        <tr>
            <td class="@tdClass">@transaction.Date.ToString("dd.MM")</td>
            <td class="@prefixClass">@prefix</td>
            <td class="@tdClass">@transaction.Name</td>
            <td class="@tdClass">@transaction.Category</td>
            <td class="@prefixClass">@prefix</td>
            <td class="@tdClass">@transaction.AmountEuro.ToString("F2") €</td>
            
            @if (!isExpected)
            {
                <td><a class="text-decoration-none" asp-action="EditTransaction" asp-route-id="@transaction.Id">📝</a></td>
                <td><button class="bg-transparent border-0" onclick="confirmDelete(@transaction.Id, '@(transaction.Name)')">❌</button></td>
            }
            
            @if (transaction.IsAutoGenerated)
            {
                <td>🔄</td>
            }
            else
            {
                <td>&nbsp;</td>
            }
        </tr>
    }
    </tbody>
</table>
